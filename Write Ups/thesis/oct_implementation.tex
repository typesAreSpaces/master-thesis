\section{Implementation}

In order to obtain a bijection between UTVPI inequalities and
natural numbers, first we define an ordering on the inequalities
and notice some invariants of the latter. 

We encode the term $\pm x_m \pm x_n$ using the point
$(\pm m, \pm n) \in \mathbb{Z}^2$. Let $TermToPoint$ be the map
that $\pm x_m \pm x_n \mapsto (\pm m, \pm n)$.The variable $x_0$ is a
\emph{dummy variable} that acts as a place holder for 0. 
Additionally, we will restrict the terms/pairs such that the absolute
value of the first index variable is strictly greater than the
absolute value of the second index variable \footnote{This condition also
  avoids the problem of keeping track of variable duplication in 
the inequality.} since addition is commutative, except for the point
(0, 0) which encodes the inequality with no variables.

We define the following orderings relevant for the terms of the form
$\pm x_m \pm x_n$.

\begin{definition} 
  Let $\succ_m$ be an ordering on the integers such that $a \succ_m b$
  if and only $|a| > |b|$ or ($|a| = |b|$ and $a > b$) where $>$ is the
  standard ordering on integers.

  Let $\succ_p$ be an ordering on pair of integers such that 
  $(m_1, n_1) \succ_p (m_2, n_2)$ if and only if $m_1 \succ_m m_2$
  or ($m_1 = m_2$ and $n_1 \succ_m n_2$).

  Let $\succ_t$ be an ordering on terms of the form $\pm x_m \pm x_n$
  such that $t_1 \succ_t t_2$ if and only if $TermToPoint(t_1) \succ_p TermToPoint(t_2)$
\end{definition}

\begin{example}
  The first 32 elements (in ascending order w.r.t. $\succ_t$) of UTVPI inequalities
  \footnote{For readability purposes we include the bound for the UTVPI term }
  are the following:

  $x_{0} + x_{0} \leq b_{0}$

  $-x_{1} + x_{0} \leq b_{1}, x_{1} + x_{0} \leq b_{2}$ 

  $-x_{2} + x_{0} \leq b_{3}, -x_{2} - x_{1} \leq b_{4}, -x_{2} + x_{1} \leq b_{5}, x_{2} + x_{0} \leq b_{6}, x_{2} - x_{1} \leq b_{7}, x_{2} + x_{1} \leq b_{8}$

  $-x_{3} + x_{0} \leq b_{9}, -x_{3} - x_{1} \leq b_{10}, -x_{3} + x_{1} \leq b_{11}, -x_{3} - x_{2} \leq b_{12}, -x_{3} + x_{2} \leq b_{13},x_{3} + x_{0} \leq b_{14}, x_{3} - x_{1} \leq b_{15}, x_{3} + x_{1} \leq b_{16}, x_{3} - x_{2} \leq b_{17}, x_{3} + x_{2} \leq b_{18}$
\end{example}

From the example, we notice that we can group/order the inequalities by groups using the first
index. The first element of the $i^{th}$ group corresponds to the $2(i-1)^2 + 1$ element in the 
$\succ_t$ order. The observation follows from an inductive argument since there are 
$2(1 + 2(i-1))$ elements in the $i^{th}$ group. It is also straight forward to find the
position of the first element in the second half of any group. With the above information
it is possible to find the map between UTVPI terms and naturals numbers.

This bijection allows us to implement a data 
structure based on a vector of integers extended
with $\pm \infty$ which encodes the upper bounds 
for the $i^{th}$ inequality present in the 
input formula. For initialization purpose all 
the entries in this vector are set to
$\infty$ and these values are updated accordingly 
to keep track to the minimum possible value 
for the inequality after the application of the 
inference rules mentioned at the
introduction of the section.

\begin{algorithm}[!ht]
  \caption{UTVPI constructor}
  \linespread{\separationline}\selectfont
  \begin{algorithmic}[2]
    \Procedure {UTVPI constructor} {position : integer}

    \State coefficient1 = 0
    \State coefficient2 = 0
    \State varindex1 = 0
    \State varindex2 = 0
    \If {position = 0}
    \State return
    \EndIf

    \State varindex1 = $\sqrt{\frac{position - 1}{2}} + 1$
    \State initial\_group\_position = $2*(varindex1-1)^2 + 1$
    \State half\_size\_group = $2*varindex1-1$

    \If {position $\leq$ initial\_group\_position + half\_size\_group}
    \State coefficient1 = -1
    \If {position = initial\_group\_position}

    \State coefficient2 = 0
    \State varindex2 = 0
    \State return
    \EndIf
    \State separation = position - initial\_group\_position
    \State varindex2 = $\frac{separation - 1}{2} + 1$
    \If {mod separation 2 = 0}
    \State coefficient2 = 1
    \State return
    \EndIf
    \State coefficient2 = -1
    \State return
    \EndIf

    \State coefficient1 = 1
    \If {position = initial\_group\_position + half\_size\_group + 1}
    \State coefficient2 = 0
    \State varindex2 = 0
    \State return
    \EndIf
    \State separation = position - initial\_group\_position - half\_size\_group - 1
    \State varindex2 = $\frac{separation - 1}{2} + 1$
    \If {mod separation 2 = 0}
    \State coefficient2 = 1
    \State return
    \EndIf
    \State coefficient2 = -1
    \State return
    \EndProcedure
  \end{algorithmic}
\end{algorithm}

\begin{algorithm}[!ht]
  \caption{UTVPI position}
  \linespread{\separationline}\selectfont
  \begin{algorithmic}[2]
    \Procedure {UTVPI position} { $s_1 x_{m_1} + s_2 x_{m_2}$ : UTVPI term}

    \State initial\_group\_position = $2*(m_1 -1)^2 + 1$

    \If { $s_1 = -1$ }
    \State sign\_a\_offset = 0
    \Else
    \If { $s_1 = 0$ }
    \State return 0
    \Else
    \If { $s_1 = 1$ }
    \State sign\_a\_offset = $2*(m_1 - 1) + 1$
    \EndIf
    \EndIf
    \EndIf

    \If { $s_2 = -1$ }
    \State sign\_b\_offset = $1 + 2*(m_2 -1)$
    \Else
    \If { $s_2 = 0$ }
    \State sign\_b\_offset = 0
    \Else
    \If { $s_2 = 1$ }
    \State sign\_b\_offset = $2*m_2$
    \EndIf
    \EndIf
    \EndIf

    \State return initial\_group\_position + sign\_a\_offset + sign\_b\_offset

    \EndProcedure
  \end{algorithmic}

\end{algorithm}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "main"
%%% End:
